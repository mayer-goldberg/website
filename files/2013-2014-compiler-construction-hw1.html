<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Assignment 1 (Due Thursday, November 7th at 13:00)</title>
<!-- 2013-10-27 Sun 12:26 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
<meta name="generator" content="Org-mode"/>
<meta name="author" content="Mayer Goldberg"/>
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link rel="shortcut icon" type="image/x-icon" href="http://www.little-lisper.org/website/favicon.ico" />
<link rel="apple-touch-icon" type="image/x-icon" href="http://www.little-lisper.org/website/favicon.png" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012  Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Assignment 1 (Due Thursday, November 7th at 13:00)</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. Parsing Molecules</a>
<ul>
<li><a href="#sec-1-1">1.1. Goals</a></li>
<li><a href="#sec-1-2">1.2. Description</a></li>
<li><a href="#sec-1-3">1.3. What we will check</a>
<ul>
<li><a href="#sec-1-3-1">1.3.1. Exceptions</a></li>
<li><a href="#sec-1-3-2">1.3.2. Completeness</a></li>
</ul>
</li>
<li><a href="#sec-1-4">1.4. What to submit</a></li>
<li><a href="#sec-1-5">1.5. Last minute instructions</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Parsing Molecules</h2>
<div class="outline-text-2" id="text-1">
</div><div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1"><span class="section-number-3">1.1</span> Goals</h3>
<div class="outline-text-3" id="text-1-1">
<p>
The goals of this assignment are:
</p>

<ul class="org-ul">
<li>To get you to learn Python quickly
</li>
<li>To get you to think about <i>grammars</i>
</li>
<li>To get you familiar with <i>parsing combinators</i>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2"><span class="section-number-3">1.2</span> Description</h3>
<div class="outline-text-3" id="text-1-2">
<p>
In this problem, you will implement a parser for the chemical notation of molecules. You need to be able to take in a string, representing a molecule in standard ASCII notation, and return an Object that represents this molecule. Your object should be able to respond to the questions about the atoms in the molecule, as well as its molecular weight, and it should have a printed string representation.
</p>

<p>
Your base class is <code>Chem</code>. The entry point for the parser is the static method <code>Chem.readMoleculeFromString</code>. This method takes a string and returns a molecule, and any remaining characters left after reading the molecule. You can create static methods in a class by preceeding the method definition with <code>@staticmethod</code>. 
</p>

<p>
Below is a sample interaction with Python, via the IDLE IDE. Remember that multi-line strings in Python are enclosed between triple double-quote marks:
</p>

<div class="org-src-container">

<pre class="src src-python">&gt;&gt;&gt; mol, remaining = Chem.readMoleculeFromString("""

{ Comments are in braces -- {they can be nested!}

}

CO2
""")
&gt;&gt;&gt; remaining
''
&gt;&gt;&gt; mol
&lt;__main__.Molecule object at 0x10378d240&gt;
&gt;&gt;&gt; str(mol)
'CO2'
&gt;&gt;&gt; mol.atoms()
{&lt;__main__.Atom object at 0x10378d390&gt;, &lt;__main__.Atom object at 0x10378d9e8&gt;}
&gt;&gt;&gt; mol.computeWeight()
44.0095
&gt;&gt;&gt; Atom('C') in mol
True
&gt;&gt;&gt; Atom('W') in mol
False
&gt;&gt;&gt; Atom('Ir')
&lt;__main__.Atom object at 0x101e19898&gt;
&gt;&gt;&gt; Atom('Iran')
Traceback (most recent call last):
  File "&lt;pyshell#17&gt;", line 1, in &lt;module&gt;
    Atom('Iran')
  File "/Users/gmayer/work/lang/python/chem/chem.py", line 264, in __init__
    raise NoSuchAtom(symbol)
NoSuchAtom: Iran
&gt;&gt;&gt; atom = Atom('Ir')
&gt;&gt;&gt; str(atom)
'Ir'
&gt;&gt;&gt; atom.number
77
&gt;&gt;&gt; atom.name
'Iridium'
&gt;&gt;&gt; atom.weight
192.217
</pre>
</div>

<p>
You can see that our parser can handle (and ignore) both whitespace and comments. Whitespaces are any blank characters (chars of ASCII 32 or less), and comments is any text that appears between beaces: <code>{...}</code>. Comments can be nested. Handling nested comments is important, because when debugging your parser, you may very well want to comment out parts of a molecule, and those in turn may have other parts commented out. For example:
</p>

<div class="org-src-container">

<pre class="src src-python">&gt;&gt;&gt; mol, remaining = Chem.readMoleculeFromString('H2SO4')
&gt;&gt;&gt; str(mol)
'H2SO4'
&gt;&gt;&gt; mol.computeWeight()
98.07848
&gt;&gt;&gt; mol, remaining = Chem.readMoleculeFromString('H2SO{4} {not a real molecule}')
&gt;&gt;&gt; str(mol)
'H2SO'
&gt;&gt;&gt; mol.computeWeight()
50.08028
&gt;&gt;&gt; mol, remaining = Chem.readMoleculeFromString('H2S{O{4}} {H2S stinks like hell!}')
&gt;&gt;&gt; str(mol)
'H2S'
&gt;&gt;&gt; mol.computeWeight()
34.08088
&gt;&gt;&gt; Atom('O') in mol
False
</pre>
</div>

<p>
Please remember that in order to support a test for membership, you will need to define the method <code>__contains__</code>. To support the <code>str( .. )</code> procedure, you will need to define the method <code>__str__</code>.
</p>

<p>
The only classes you are <i>required</i> to have are <code>Chem</code> and <code>Atom</code>. As long as you support all the functionality we ask for, in the interface we ask for, we do not care what additional classes and methods you choose to implement. Nevertheless, I recommend that you use consider my choice of classes:
</p>


<div class="figure">
<p><img src="./my-class-diagram.png" width="100% wrap" alt="my-class-diagram.png"/></p>
</div>

<p>
As you can see, the classes <code>Atom</code>, <code>Multiplicity</code>, <code>Group</code>, and <code>Molecule</code> inherit from <code>Chem</code>. I also make extensive use of the <a href="http://en.wikipedia.org/wiki/Visitor_pattern"><i>visitor pattern</i></a>, because it keeps common functionality together, and reduces the size of the main classes.
</p>

<ul class="org-ul">
<li>An <i>atom</i> contains a <i>symbol</i> (e.g., 'Au', for gold), a <i>name</i> (e.g., 'Gold'), an atomic number, and an atomic weight. This information will be given to you in the form of a huge hash table <code>periodicTable</code>, which you will include in your source file. 
</li>
<li>A <i>group</i> contains two things, either one of which may be an atom, a group, or a multiplicity. Examples of groups include: OH, ClO, etc.
</li>
<li>A <i>multiplicity</i> contains either an atom, a group, or a multiplicity, and an integer that denotes <i>how many times</i> this atom or group appears in the molecule. Examples of multiplicities include: O<sub>4</sub>, (SO<sub>4</sub>)<sub>3</sub>, etc.
</li>
<li>A <i>molecule</i> contains either an atom, a group or a multiplicity. It is intended to provide some abstraction and possibly some future functionality. 
</li>
</ul>

<p>
The parser <b>must</b> be written using the parsing combinators module <code>pc.py</code>. The file is available for download right under the assignment statement. Parsing combinators will be explained to you in your recitation sections. 
</p>
</div>
</div>
<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3"><span class="section-number-3">1.3</span> What we will check</h3>
<div class="outline-text-3" id="text-1-3">
</div><div id="outline-container-sec-1-3-1" class="outline-4">
<h4 id="sec-1-3-1"><span class="section-number-4">1.3.1</span> Exceptions</h4>
<div class="outline-text-4" id="text-1-3-1">
<ul class="org-ul">
<li>We expect your code to perform full error checking on its input, and generate a <code>pc.NoMatch</code> exception if it is unable to read a molecule from the given string. 
</li>
</ul>
<div class="org-src-container">

<pre class="src src-python">&gt;&gt;&gt; try:
	m, s = Chem.readMoleculeFromString('(NH4)3PO4')
	print(m)
except pc.NoMatch as e:
	print('raises an exception')


(NH4)3PO4
&gt;&gt;&gt; try:
	m, s = Chem.readMoleculeFromString('[NH4)3PO4')
	print(m)
except pc.NoMatch as e:
	print('raises an exception')


raises an exception
</pre>
</div>
<ul class="org-ul">
<li>Your code should generate a <code>NoSuchAtom</code> exception when the user attempts to create an atom that does not exist in the hash table <code>periodicTable</code> you will be given. You should not modify this table!
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-3-2" class="outline-4">
<h4 id="sec-1-3-2"><span class="section-number-4">1.3.2</span> Completeness</h4>
<div class="outline-text-4" id="text-1-3-2">
<ul class="org-ul">
<li>Chemical formulas can be written with or without whitespaces between atoms, groups, and their multiplicities.
</li>
<li>Whitespaces may not appear between letters of the symbol of a single chemical element. <code>Fe</code> is fine, but <code>F   e</code> is not.
</li>
<li>An element symbol starts with an uppercase letter, and may be followed by zero or more lowercase letters. 
<ul class="org-ul">
<li>Your parser should be case-sensitive: For example, HF is <i>hydrofluric acid</i>, a molecule made up of <i>hydrogen</i> and <i>fluorine</i>, whereas Hf is the element <i>Hafnium</i>.
</li>
<li>Newly discovered elements tend to get 3 letters (at least at first). For example, Uuu is the original symbol for the 111-th element, currently named <i>Roentgenium</i>. There are other examples of 3-letter elements.
</li>
</ul>
</li>
<li>Multiplicities are written as natural numbers. These do not start with the digit <code>0</code>. They can be several digits long. 
</li>
<li>Groups can be surrounded by either parenthesis or brackets. These must match: <code>Fe4[Fe(CN)6]3</code> is fine, but the following are <i>not</i>: <code>Fe4[Fe(CN)6)3</code>, <code>Fe4[Fe(CN]6]3</code>, <code>Fe4(Fe(CN)6]3</code>, etc. Consider the following example:
</li>
</ul>
<div class="org-src-container">

<pre class="src src-python">&gt;&gt;&gt; mol, remaining = Chem.readMoleculeFromString('Fe4 [Fe (CN)6]3')
&gt;&gt;&gt; mol
&lt;__main__.Molecule object at 0x1037aa0b8&gt;
&gt;&gt;&gt; str(mol)
'Fe4(Fe(CN)6)3'
&gt;&gt;&gt; remaining
''
&gt;&gt;&gt; mol, remaining = Chem.readMoleculeFromString('Fe4 (Fe (CN)6]3')
&gt;&gt;&gt; str(mol)
'Fe4'
&gt;&gt;&gt; remaining
'(Fe (CN)6]3'
&gt;&gt;&gt; mol, remaining = Chem.readMoleculeFromString(remaining)
Traceback (most recent call last):
  File "/Users/gmayer/work/lang/python/lib/pc.py", line 45, in match
    return self.pc1.match(s)
  File "/Users/gmayer/work/lang/python/lib/pc.py", line 119, in match
    raise NoMatch
pc.NoMatch
</pre>
</div>
<blockquote>
<p>
When an entire string does not match a molecule, it may sometimes be possible to read off part of that string. In the above example, the parenthesis don't match, so the entire string does not correspond to a molecule. However, it is possible to create "a molecule" (not that such a molecule could ever exist) by reading off the head of the string. If you examine the remaining characters it should become clear that "the molecule" is Fe<sub>4</sub> (!).
</p>
</blockquote>
<ul class="org-ul">
<li>The string representation of a molecule should use <i>the least number of parenthesis</i> that is necessary to print a molecule. For example:
</li>
</ul>
<div class="org-src-container">

<pre class="src src-python">&gt;&gt;&gt; mol, remaining = Chem.readMoleculeFromString('(H)2((O)2)')
&gt;&gt;&gt; str(mol)
'H2O2'
&gt;&gt;&gt; mol, remaining = Chem.readMoleculeFromString('((Al)2)((((S)O4)3))')
&gt;&gt;&gt; str(mol)
'Al2(SO4)3'
</pre>
</div>
<blockquote>
<p>
The string representation should only use parenthesis <code>()</code> in the output. Not brackets <code>[]</code>.
</p>
</blockquote>
<ul class="org-ul">
<li>Comments are matching braces <code>{ ... }</code> and anything in between, including other nested comments. The idea is that you can comment out whole molecules or parts of molecules, and these in turn may include other comments. 
</li>
</ul>

<div class="org-src-container">

<pre class="src src-python">&gt;&gt;&gt; mol, remaining = Chem.readMoleculeFromString('C27 {lala} H28 Br2 O5 {{lulu} is back in town!} S')
&gt;&gt;&gt; str(mol)
'C27H28Br2O5S'
&gt;&gt;&gt; remaining
''
&gt;&gt;&gt; Atom('C') in mol
True
&gt;&gt;&gt; Atom('H') in mol
True
&gt;&gt;&gt; Atom('Br') in mol
True
&gt;&gt;&gt; Atom('O') in mol
True
&gt;&gt;&gt; Atom('S') in mol
True
&gt;&gt;&gt; Atom('Lu') in mol
False
</pre>
</div>
<blockquote>
<p>
Please do not derogate such issues as whitespace, matching parentheses, and comments. This assignment is about parsing, and while in "real life" you may not take comments seriously, they actually provide a wonderful example of a small, but non-trivial sub-grammar for your parser.
</p>
</blockquote>
</div>
</div>
</div>
<div id="outline-container-sec-1-4" class="outline-3">
<h3 id="sec-1-4"><span class="section-number-3">1.4</span> What to submit</h3>
<div class="outline-text-3" id="text-1-4">
<p>
You should submit a <i>zip</i> file <code>hw1.zip</code>, that creates a directory <code>hw1</code> containing:
</p>
<ul class="org-ul">
<li>The file <code>chem.py</code>. You should not inlcude <code>pc.py</code>, nor should you include its content in <code>chem.py</code>. 
</li>
<li>A file <code>readme.txt</code> that contains the names, IDs, and email addresses of all group members (you may either work alone, or with a single partner), as well as the following statement:
</li>
</ul>

<blockquote>
<p>
I(We), &lt;fill in your name(s)&gt;, declare the following to be true:
</p>
<ul class="org-ul">
<li>We worked on this assignment alone. We did not consult with others about this assignment, other than the teaching staff for this course.
</li>
<li>We did not copy code either from other students or from the internet.
</li>
<li>We did not make available this code to other students taking this course.
</li>
<li>We are aware of the University, faculty (as specified in the &rlm;שנתון&lrm;), departmental, and course policies (as specified in the syllabus) on academic dishonesty: We realize that if we are found to have committed academic dishonesty that we shall be sent before the disciplinary committee (&rlm;ועדת משמעת&lrm;), fail the course, and possibly incur other penalties as decided by the disciplinary committee. 
</li>
</ul>
</blockquote>

<p>
We will not grade any work submitted that does not include the above statement. Please do not forget to include it, with your names spelled out. If you do not do this, for any reason, then at the very least, you will incur the 5% per diem late penalty (as specified in the course syllabus). 
</p>
</div>
</div>
<div id="outline-container-sec-1-5" class="outline-3">
<h3 id="sec-1-5"><span class="section-number-3">1.5</span> Last minute instructions</h3>
<div class="outline-text-3" id="text-1-5">
<ul class="org-ul">
<li>We will be using our own version of <code>pc.py</code> to test and debug your code, so please do not rely on changes you might make to that file.
</li>
<li><b>PLEASE</b> do make sure that your work runs on the departmental Linux machines. It will save you much grief later on!
</li>
<li><b>PLEASE</b> do go over the submission instructions carefully, and make sure you did not leave out anything. 
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Mayer Goldberg</p>
<p class="date">Created: 2013-10-27 Sun 12:26</p>
<p class="xhtml-validation"><a href="http://validator.w3.org/check?uri=referer">Validate XHTML 1.0</a></p>
</div>
</body>
</html>